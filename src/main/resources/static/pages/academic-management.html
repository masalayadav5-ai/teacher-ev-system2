<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Academic Management - SmarTeach</title>
        <link rel="stylesheet" href="/css/academic-management.css">
        <link rel="stylesheet" href="/css/common.css">

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    </head>
    <body>
        <div class="academic-management-container">
            <!-- Header -->
            <div class="page-header">
                <h2 class="page-title">
                    <i class="fas fa-cogs me-2"></i>Academic Management
                </h2>
            </div>
            <p class="page-subtitle">Manage Programs, Semesters, Courses & Teacher Assignments</p>

            <!-- Tabs Navigation -->
            <div class="management-tabs">
                <div class="tabs-header">
                    <button class="tab-btn active" onclick="showTab('programs', event)">
                        <i class="fas fa-graduation-cap"></i> Programs
                    </button>
                    <button class="tab-btn" onclick="showTab('semesters', event)">
                        <i class="fas fa-calendar-alt"></i> Semesters
                    </button>
                    <button class="tab-btn" onclick="showTab('courses', event)">
                        <i class="fas fa-book"></i> Courses
                    </button>
                    <button class="tab-btn" onclick="showTab('teacher-assignments', event)">
                        <i class="fas fa-chalkboard-teacher"></i> Teacher Assignments
                    </button>
                    <button class="tab-btn" onclick="showTab('overview', event)">
                        <i class="fas fa-eye"></i> Overview
                    </button>
                </div>

                <!-- Tab Contents -->
                <div class="tab-content">
                    <!-- Programs Tab -->
                    <div id="programs-tab" class="tab-pane active">
                        <div class="tab-header">
                            <h3><i class="fas fa-graduation-cap me-2"></i>Programs Management</h3>
                            <button class="btn-add programAdd" onclick="openAddProgramModal()">
                                <i class="fas fa-plus"></i> Add Program
                            </button>
                        </div>

                        <div class="table-container">
                            <table class="management-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Code</th>
                                        <th>Name</th>
                                        <th>Description</th>
                                        <th>Semesters</th>
                                        <th>Students</th>
                                        <th>Teachers</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="programsTable">
                                    <!-- Programs will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Semesters Tab -->
                    <div id="semesters-tab" class="tab-pane">
                        <div class="tab-header">
                            <h3><i class="fas fa-calendar-alt me-2"></i>Semesters Management</h3>
                            <div class="filter-section">
                                <select id="programFilter" class="form-select" onchange="loadSemestersByProgram()">
                                    <option value="">Select Program</option>
                                    <!-- Programs will be loaded here -->
                                </select>
                                <button class="btn-add semesterAdd" onclick="openAddSemesterModal()">
                                    <i class="fas fa-plus"></i> Add Semester
                                </button>
                            </div>
                        </div>

                        <div class="table-container">
                            <table class="management-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Program</th>

                                        <th>Courses</th>
                                        <th>Students</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="semestersTable">
                                    <!-- Semesters will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Courses Tab -->
                    <div id="courses-tab" class="tab-pane">
                        <div class="tab-header">
                            <h3><i class="fas fa-book me-2"></i>Courses Management</h3>
                            <div class="filter-section">
                                <select id="courseProgramFilter" class="form-select" onchange="loadSemestersForCourses()">
                                    <option value="">Select Program</option>
                                </select>
                                <select id="courseSemesterFilter" class="form-select" onchange="loadCoursesBySemester()">
                                    <option value="">Select Semester</option>
                                </select>
                                <button class="btn-add courseAdd" onclick="openAddCourseModal()">
                                    <i class="fas fa-plus"></i> Add Course
                                </button>
                            </div>
                        </div>

                        <div class="table-container">
                            <table class="management-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Code</th>
                                        <th>Name</th>
                                        <th>Description</th>
                                        <th>Credits</th>
                                        <th>Semester</th>
                                        <th>Teachers</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="coursesTable">
                                    <!-- Courses will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Teacher Assignments Tab -->
                    <!-- In Teacher Assignments Tab -->
                    <div id="teacher-assignments-tab" class="tab-pane">
                        <div class="tab-header">
                            <h3><i class="fas fa-chalkboard-teacher me-2"></i>Teacher Course Assignments</h3>
                           
                        </div>

                        <div class="assignment-container">
                            <div class="teacher-list">
                                <h4>Teachers</h4>
                                <!-- NEW: Program filter inside teacher list -->
    <select id="teacherProgramFilter"
            class="form-select mb-3"
            onchange="loadTeachersByProgram()">
        <option value="">Select Teacher Program</option>
    </select>
                                <div id="teachersList" class="list-group">
                                    <!-- Teachers will be loaded here -->
                                </div>
                            </div>

                            <div class="course-assignment">
                             
<h4>
    Course Assignments â€”
    <span id="selectedTeacherName">Please select a teacher</span>
</h4>
                                 <div class="filter-section">
                         
                                <!-- Course Program Filter (for fetching available courses) -->
                                <select id="courseProgramForAssignFilter" class="form-select" onchange="loadSemestersForCourseAssignments()">
                                    <option value="">Select Course Program</option>
                                </select>

                                <!-- Course Semester Filter (for fetching available courses) -->
                                <select id="courseSemesterForAssignFilter" class="form-select" onchange="loadAvailableCourses()">
                                    <option value="">Select Course Semester</option>
                                </select>

                            </div>   
                                <div class="available-courses">
                                    <h5>Available Courses</h5>
                                    <div id="availableCourses" class="courses-list">
                                        <!-- Available courses will be loaded here -->
                                    </div>
                                </div>
                                <div class="assigned-courses">
                                    <h5>Assigned Courses</h5>
                                    <div id="assignedCourses" class="courses-list">
                                        <!-- Assigned courses will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Overview Tab -->
                    <div id="overview-tab" class="tab-pane">
                        <div class="tab-header">
                            <h3><i class="fas fa-eye me-2"></i>Academic Structure Overview</h3>
                        </div>

                        <div class="overview-stats">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-value" id="totalPrograms">0</div>
                                    <div class="stat-label">Programs</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-calendar-alt"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-value" id="totalSemesters">0</div>
                                    <div class="stat-label">Semesters</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-value" id="totalCourses">0</div>
                                    <div class="stat-label">Courses</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-chalkboard-teacher"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-value" id="totalAssignments">0</div>
                                    <div class="stat-label">Assignments</div>
                                </div>
                            </div>
                        </div>

                        <div class="structure-tree">
                            <h4>Academic Structure Tree</h4>
                            <div id="structureTree" class="tree-view">
                                <!-- Tree structure will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MODALS -->

        <!-- Add/Edit Program Modal -->
        <div id="programModal" class="modal-overlay">
            <div class="modal-content">
                <div class="modal-header">
                    <h4><i class="fas fa-graduation-cap me-2"></i><span id="programModalTitle">Add New Program</span></h4>
                    <button class="modal-close" onclick="closeProgramModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="programForm">
                        <input type="hidden" id="programId">
                        <div class="form-group">
                            <label>Program Code *</label>
                            <input type="text" id="programCode" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Program Name *</label>
                            <input type="text" id="programName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="programDescription" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="programStatus" class="form-control">
                                <option value="true">Active</option>
                                <option value="false">Inactive</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeProgramModal()">Cancel</button>
                    <button class="btn-primary" onclick="saveProgram()">Save Program</button>
                </div>
            </div>
        </div>

        <!-- Add/Edit Semester Modal -->
        <div id="semesterModal" class="modal-overlay">
            <div class="modal-content">
                <div class="modal-header">
                    <h4><i class="fas fa-calendar-alt me-2"></i><span id="semesterModalTitle">Add New Semester</span></h4>
                    <button class="modal-close" onclick="closeSemesterModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="semesterForm">
                        <input type="hidden" id="semesterId">
                        <div class="form-group">
                            <label>Program *</label>
                            <select id="semesterProgram" class="form-control" required>
                                <option value="">Select Program</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Semester Name *</label>
                            <input type="text" id="semesterName" class="form-control" required>
                        </div>

                        <div class="form-group">
                            <label>Status</label>
                            <select id="semesterStatus" class="form-control">
                                <option value="true">Active</option>
                                <option value="false">Inactive</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeSemesterModal()">Cancel</button>
                    <button class="btn-primary" onclick="saveSemester()">Save Semester</button>
                </div>
            </div>
        </div>

        <!-- Add/Edit Course Modal -->
        <div id="courseModal" class="modal-overlay">
            <div class="modal-content">
                <div class="modal-header">
                    <h4><i class="fas fa-book me-2"></i><span id="courseModalTitle">Add New Course</span></h4>
                    <button class="modal-close" onclick="closeCourseModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="courseForm">
                        <input type="hidden" id="courseId">
                        <div class="form-group">
                            <label>Program *</label>
                            <select id="courseProgram" class="form-control" required onchange="loadSemestersForCourseModal()">
                                <option value="">Select Program</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Semester *</label>
                            <select id="courseSemester" class="form-control" required>
                                <option value="">Select Semester</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Course Code *</label>
                            <input type="text" id="courseCode" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Course Name *</label>
                            <input type="text" id="courseName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="courseDescription" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Credits</label>
                            <input type="number" id="courseCredits" class="form-control" min="1" max="10" value="3">
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="courseStatus" class="form-control">
                                <option value="true">Active</option>
                                <option value="false">Inactive</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeCourseModal()">Cancel</button>
                    <button class="btn-primary" onclick="saveCourse()">Save Course</button>
                </div>
            </div>
        </div>    
        <!-- Initialize when DOM is loaded -->
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                // Load the admin management functions first
                if (typeof initAdminManagement === 'function') {
                    initAdminManagement();
                } else {
                    // If functions aren't loaded yet, wait a bit
                    console.log('Admin functions not loaded, waiting...');
                    setTimeout(function () {
                        if (typeof initAdminManagement === 'function') {
                            initAdminManagement();
                        } else {
                            console.error('Admin management functions not found');
                            alert('Error loading admin management. Please refresh the page.');
                        }
                    }, 500);
                }
            });
        </script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
 

    </body>
</html>